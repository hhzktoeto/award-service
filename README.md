# Награды сотрудников - микросервис

## ТЗ
- Принимает файл табличного формата (`.xls`, `.xlsx` или `.csv`); 
- Файл содержит данные о сотруднике (_его ID и ФИО_) и награде, которую сотрудник получил (_ID награды, её название и дата получения_); 
- Сохраняет полученные данные в БД при условии наличия сотрудника с указанным ID.
- Корректность реализации должна быть подтверждена unit-тестами с использованием JUnit5

## Техстэк
- Java 21
- Spring Boot 3.5.7
- Gradle 8.14.3

## Конфигурация

### Переменные окружения
В конфигурационном файле по пути **_src/main/resources/application.yaml_** указаны ссылки на переменные окружения 
для настройки порта для HTTP сервера и DataSource для Базы данных PostgreSQL.

Пример в файле **_env.example_**, который находится в корневой директории проекта.

### База данных
Для создания таблиц в PostgreSQL используется liquibase. Файл миграции лежит по пути **_src/main/resources/db/changelog/db.changelog-master.yaml_**,
скрипты лежат рядом с вышеупомянутым файлом, в директории **_changes_**;

### Логирование
В конфигурационном файле **_application.yaml_** настроено логирование в консоль и файл с ротацией логов. Для отключения
логирования в файл необходимо запустить микросервис с активным _dev_ профилем - `--spring.profiles.active=dev` 

## Обоснование выбора реализации REST API

Для реализации REST API выбран Spring MVC по следующим причинам:

- Выбранная модель полностью соответствует требованиям ТЗ. Обработка multipart файлов форматов **.xlsx** и **.csv** поддерживается MVC и выполняется эффективно; 
- Нет указаний на высокую нагрузку, необходимость выполнения асинхронных задач или интеграцию с внешними сервисами. Без этих требований реализаций non-blocking IO не имеет смысла; 
- Работа с файлами указанного формата происходит синхронно в любом случае; 
- Отпадает необходимость использования дополнительных инструментов для реактивного тестирования.

**Вывод: WebFlux для текущей задачи - overkill**

## Условия, доопределённые самостоятельно

1. **Какой ответ необходимо возвращать в случаях :**
   1. _**Если хотя бы одна из записей в файле некорректная** - решено не обрабатывать такой файл и возвращать ответ со статусом 400_
   2. _**Если по одной или нескольким записям не найден сотрудник с указанным ID** - решено пропустить эту запись и продолжать обработку остальных записей_
   3. _**Если все записи обработаны корректно** - решено дополнять стандартный ответ 200 OK сообщением о том, сколько записей из файла было корректно обработано_
2. **Есть ли у входящих файлов строка-заголовок** - решено учитывать наличие заголовка, так как такой формат будет использован с бóльшей вероятностью, из-за удобства заполнения;
3. **Каким должно быть ограничение на максимальный размер файла** - решено не изменять стандартное ограничение Spring Boot - **2Мб**